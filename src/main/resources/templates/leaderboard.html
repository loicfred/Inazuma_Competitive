<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="MASTERCONTENT">

<head layout:fragment="head">
    <meta property="og:title" content="Leaderboard | Inazuma Competitive" />
    <meta property="og:description" content="The leaderboard of Inazuma Competitive. See who is the best player in the community and what they have achieved." />
    <meta property="og:image" content="/img/avatar.png" />
    <meta name="twitter:title" content="Leaderboard | Inazuma Competitive">
    <meta name="twitter:description" content="The leaderboard of Inazuma Competitive. See who is the best player in the community and what they have achieved.
            You will find everything you want about the community.">
    <meta name="twitter:image" content="/img/avatar.png">
    <title>Leaderboard | Inazuma Competitive</title>
    <link id="tabIcon" rel="icon" href="/img/avatar.png" type="image/png">

    <style>
        main {
            background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url("/img/bg.jpg");
            background-size: cover;
            background-position: center;
            color: white;
        }
        header, footer, .dropdown, #loading {
            background-color: #000645;
        }
        input:checked + .slider, input:checked + .minislider {
            background-color: #000c87;
        }

        td {
            text-align: left;
        }

        .content {
            flex: 3;
            color: white;
            background-color: rgb(30, 30, 30);
            justify-content: space-between;
            align-items: center;
            padding: 10px 40px 60px 40px;
            min-height: 100vh;
        }
        .content h1 {
            font: 2.5rem IEBold, sans-serif;
            margin-bottom: 20px;
        }
        .content p {
            line-height: 1.5;
            font: 1.0rem IEStrike, sans-serif;
        }

        @media screen and (max-width: 768px) {
            .content {
                padding: 15px;
                max-width: 100%;
            }
            .content h1 {
                font-size: 20px;
                margin-bottom: 20px;
            }
            .content p {
                line-height: 1.4;
                font-size: 12px;
            }
            .tournament-panel-details-buttons a {
                font-size: 12px;
            }
        }
    </style>
</head>

<main layout:fragment="content">
    <section class="content">
        <div id="leaderboard-switches" style="display: flex; flex-wrap: wrap; align-items: center;"></div>
        <h5 id="itemload" class="IEBOLD" style="text-align: center; padding-top: 100px">Loading...</h5>
        <div id="leaderboard"></div>
    </section>
</main>

</html>

<script>
    generateSwitches('leaderboard-switches', 'Tourn', commonItems, 'showLeaderboards');
    function showLeaderboards(selected) {
        if (document.querySelector("input[name='Tourn-ALL']").checked === true && selected === "Tourn-ALL") {
            document.querySelector("input[name='Tourn-IEGOGLX']").checked = false;
            document.querySelector("input[name='Tourn-IEGOCS']").checked = false;
            document.querySelector("input[name='Tourn-IEGO1']").checked = false;
            document.querySelector("input[name='Tourn-IEVRBETA']").checked = false;
            document.querySelector("input[name='Tourn-IEVR']").checked = false;
            document.querySelector("input[name='Tourn-IEGOSTR']").checked = false;
            document.querySelector("input[name='Tourn-IEGOSTRXTR']").checked = false;
            fetch(`/LeaderboardData`)
                .then(res => res.text())
                .then(html => {
                    document.getElementById("itemload").classList.add("d-none");
                    document.getElementById("leaderboard").innerHTML = html;
                });
        } else {
            document.querySelector("input[name='Tourn-ALL']").checked = false;
            // List of checkbox values to check
            const gameKeys = [
                "IEGOGLX", "IEGOCS", "IEGO1", "IEVRBETA", "IEVR", "IEGOSTR", "IEGOSTRXTR"
            ];

            // Get checked values
            const selectedGames = gameKeys.filter(key => {
                return document.querySelector(`input[name='Tourn-${key}']`)?.checked;
            });

            // Join them in a comma-separated string
            const g = selectedGames.join(",");

            fetch(`/LeaderboardData?g=${encodeURIComponent(g)}`)
                .then(res => res.text())
                .then(html => {
                    document.getElementById("itemload").classList.add("d-none");
                    document.getElementById("leaderboard").innerHTML = html;
                });
        }
    }
    showLeaderboards("Tourn-ALL");
</script>
<script>
    let StatsSortDirection = [];
    function sortStats(colIndex) {
        const table = document.getElementById("statsTable");
        const tbody = table.tBodies[0];
        const rows = Array.from(tbody.querySelectorAll("tr"));

        // Toggle direction
        StatsSortDirection[colIndex] = !StatsSortDirection[colIndex];
        const direction = StatsSortDirection[colIndex] ? -1 : 1;

        rows.sort((a, b) => {
            const aText = a.cells[colIndex].innerText.trim();
            const bText = b.cells[colIndex].innerText.trim();

            const aNum = parseFloat(aText.replace(/[^\d.-]/g, ''));
            const bNum = parseFloat(bText.replace(/[^\d.-]/g, ''));

            // If numeric sort
            if (!isNaN(aNum) && !isNaN(bNum)) {
                return (aNum - bNum) * direction;
            }

            // Else string sort
            return aText.localeCompare(bText) * direction;
        });

        rows.forEach(row => tbody.appendChild(row)); // Re-append in new order
    }
</script>